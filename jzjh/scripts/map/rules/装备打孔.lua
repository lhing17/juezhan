---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by G_Seinfeld.
--- DateTime: 2018/11/16 12:47
---
--装备打孔
function xQ()
    return GetPlayerController(GetOwningPlayer(GetTriggerUnit())) == MAP_CONTROL_USER and GetItemTypeId(GetManipulatedItem()) == 1227896398
end
function yQ()
    local u = GetTriggerUnit()
    local p = GetOwningPlayer(u)
    local i11 = 0
    local i12 = 0
    if GetItemType(UnitItemInSlotBJ(u, 1)) == ITEM_TYPE_ARTIFACT or GetItemType(UnitItemInSlotBJ(u, 1)) == ITEM_TYPE_PURCHASABLE or GetItemType(UnitItemInSlotBJ(u, 1)) == ITEM_TYPE_CHARGED then
        i12 = ModuloInteger(GetItemUserData(UnitItemInSlotBJ(u, 1)) // 1000, 10)
        i11 = ModuloInteger(GetItemUserData(UnitItemInSlotBJ(u, 1)) // 100, 10)
        if i11 > 0 then
            i12 = i12 + 1
        end
        i11 = ModuloInteger(GetItemUserData(UnitItemInSlotBJ(u, 1)) // 10, 10)
        if i11 > 0 then
            i12 = i12 + 1
        end
        i11 = ModuloInteger(GetItemUserData(UnitItemInSlotBJ(u, 1)), 10)
        if i11 > 0 then
            i12 = i12 + 1
        end
        if i12 < 3 then
            SetItemUserData(UnitItemInSlotBJ(u, 1), GetItemUserData(UnitItemInSlotBJ(u, 1)) + 1000)
            DisplayTimedTextToPlayer(p, 0, 0, 30, "|cff00ffff打孔成功！")
        else
            unitadditembyidswapped(1227896398, u)
            DisplayTimedTextToPlayer(p, 0, 0, 30, "|cffff0000第一格物品不能再打孔了")
        end
    else
        unitadditembyidswapped(1227896398, u)
        DisplayTimedTextToPlayer(p, 0, 0, 30, "|cffff0000第一格物品不是装备")
    end
    u = nil
    p = nil
end

local function init()
    -- 装备打孔
    pr = CreateTrigger()
    TriggerRegisterAnyUnitEventBJ(pr, EVENT_PLAYER_UNIT_USE_ITEM)
    TriggerAddCondition(pr, Condition(xQ))
    TriggerAddAction(pr, yQ)
end
init()