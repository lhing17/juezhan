---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by G_Seinfeld.
--- DateTime: 2018/12/21 0021 19:00
---

--唐诗剑法
function LF()
    return GetEventDamage() == 0.31
end
function MF()
    local i = 1 + GetPlayerId(GetOwningPlayer(GetEventDamageSource()))
    local u = udg_hero[i]
    local uc = GetTriggerUnit()
    local shxishu = 1.0
    local shanghai = 0.0
    local loc = GetUnitLoc(uc)
    if GetUnitAbilityLevel(u, 1093678666) ~= 0 then
        shxishu = shxishu + 0.6
    end
    if GetUnitAbilityLevel(u, 1093678918) ~= 0 then
        shxishu = shxishu + 0.8
    end
    if GetUnitAbilityLevel(u, 1093678936) ~= 0 then
        shxishu = shxishu + 1.0
    end
    if GetUnitAbilityLevel(u, 1093678666) ~= 0 and GetUnitAbilityLevel(u, 1093678918) ~= 0 and GetUnitAbilityLevel(u, 1093678936) ~= 0 and GetUnitAbilityLevel(u, 1093678669) ~= 0 and GetUnitAbilityLevel(u, 1093678935) ~= 0 and GetUnitAbilityLevel(u, 1093679156) ~= 0 and GetUnitAbilityLevel(u, 1093678930) ~= 0 then
        shxishu = shxishu * 7 * 2
    end
    shanghai = ShangHaiGongShi(u, uc, 75, 75, shxishu, 1093678897)
    WuGongShangHai(u, uc, shanghai)
    if GetUnitAbilityLevel(u, 1093678669) ~= 0 and GetRandomInt(1, 10) < 5 and UnitHasBuffBJ(uc, 1110454323) == false then
        general_buff(u, uc, 3)
    end
    if GetUnitAbilityLevel(u, 1093678935) ~= 0 and GetRandomInt(1, 10) < 5 and UnitHasBuffBJ(uc, 1113813609) == false then
        general_buff(u, uc, 4)
    end
    if GetUnitAbilityLevel(u, 1093679156) ~= 0 and GetRandomInt(1, 10) < 5 and UnitHasBuffBJ(uc, 1110454324) == false then
        general_buff(u, uc, 7)
    end
    if GetUnitAbilityLevel(u, 1093678930) ~= 0 then
        SetWidgetLife(u, GetUnitState(u, UNIT_STATE_LIFE) + shanghai * 0.02)
    end
    WuGongShengChong(GetEventDamageSource(), 1093678897, 950.0)
    RemoveLocation(loc)
    u = nil
    uc = nil
    loc = nil
end
t = CreateTrigger()
YDWESyStemAnyUnitDamagedRegistTrigger(t)
TriggerAddCondition(t, Condition(LF))
TriggerAddAction(t, MF)