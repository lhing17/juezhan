---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by G_Seinfeld.
--- DateTime: 2018/11/5 0005 21:52
---

local common_util = require 'jass.util.common_util'
local unitpool = {}

local mt = {}
unitpool.__index = mt
mt.type = 'unitpool'

function mt:destroy()
    unitpool[self.handle_id] = nil
end

function mt:add_unit_type(unit_id, weight)
    self[unit_id] = weight
end

function mt:remove_unit_type(unit_id)
    self[unit_id] = nil
end

function mt:pick_random_unit_type()
    local total_weight = 0
    for _, v in pairs(self) do
        total_weight = total_weight + v
    end
    local possibility = math.random(total_weight)
    local aggregate_weight = 0
    local unit_id = 0
    for k, v in pairs(self) do
        aggregate_weight = aggregate_weight + v
        if possibility < aggregate_weight then
            return k
        end
        unit_id = k
    end
    return unit_id
end

function unitpool.create()
    local up = setmetatable({}, unitpool)
    up.handle_id = common_util.generate_handle_id()
    unitpool[up.handle_id] = up
    return up
end


return unitpool